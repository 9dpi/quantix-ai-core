<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantix Lab | Quantix AI Core</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/png" href="../static/img/favicon.png">
    <style>
        /* Bento Layout Enhancements */
        .lab-bento-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 32px;
            margin-top: 40px;
        }

        .bento-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
            font-size: 0.75rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .select-bar {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 40px;
        }

        .select-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1.5fr 1.2fr;
            gap: 20px;
            align-items: flex-end;
        }

        /* Input Styling */
        .lab-input {
            width: 100%;
            background: #000;
            color: #fff;
            border: 1px solid var(--border);
            padding: 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-family: 'Inter', sans-serif;
            transition: border-color 0.2s;
        }

        .lab-input:focus {
            border-color: var(--accent);
            outline: none;
        }

        /* Fix Calendar Icon Color - Invert to White */
        input[type="datetime-local"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        .label-tiny {
            display: block;
            font-size: 0.65rem;
            color: var(--accent);
            font-weight: 800;
            margin-bottom: 8px;
            letter-spacing: 0.05em;
        }

        .reasoning-box {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            padding: 40px;
            border-radius: 20px;
            height: 100%;
        }

        .reference-card-bento {
            background: var(--bg-sub);
            border: 1px solid var(--border);
            padding: 32px;
            border-radius: 20px;
            position: relative;
        }

        @media (max-width: 992px) {
            .lab-bento-grid {
                grid-template-columns: 1fr;
            }

            .select-grid {
                grid-template-columns: 1fr 1fr;
            }

            .btn-run-wrap {
                grid-column: 1 / -1;
            }
        }

        @media (max-width: 600px) {
            .select-grid {
                grid-template-columns: 1fr;
            }

            .signals-header h1 {
                font-size: 2rem !important;
            }

            .reasoning-box {
                padding: 24px;
            }
        }
    </style>
</head>

<body class="scrollable-page">
    <header class="app-header">
        <div class="logo-area">
            <div class="logo-icon"></div>
            <span class="logo-text">QUANTIX AI CORE</span>
        </div>
        <div class="hamburger" id="menu-toggle">‚ò∞</div>
        <nav class="main-nav" id="main-nav">
            <a href="../" class="nav-link">Overview</a>
            <a href="../dashboard/" class="nav-link">Live System</a>
            <a href="../signals/" class="nav-link">Market Reference</a>
            <a href="../lab/" class="nav-link active">Quantix Lab</a>
            <a href="../api/" class="nav-link">API</a>
            <a href="../disclaimer/" class="nav-link">Legal</a>
        </nav>
        <div class="status-tag hide-mobile"
            style="width: 240px; display: flex; justify-content: flex-end; font-size: 0.7rem; color: var(--text-dim); align-items: center; gap: 8px;">
            <div class="dot dot-online"></div> LAB_EXPLORER_ACTIVE
        </div>
    </header>

    <main class="content-container">
        <!-- TOP CONTEXT BANNER -->
        <div
            style="background: rgba(56, 189, 248, 0.05); border: 1px solid rgba(56, 189, 248, 0.2); padding: 12px; border-radius: 100px; margin-bottom: 40px; text-align: center; max-width: 600px; margin-left: auto; margin-right: auto;">
            <span style="font-size: 0.75rem; color: var(--text-dim);">üß™ <strong>Quantix Lab</strong> ‚Äî Explore how AI
                interpreted the market at any given timestamp.</span>
        </div>

        <div class="signals-header" style="margin-bottom: 60px;">
            <h1 style="font-size: 3rem; font-weight: 800; margin-bottom: 12px; letter-spacing: -0.03em;">Quantix Lab
            </h1>
            <p
                style="color: var(--accent); font-weight: 700; font-size: 1.1rem; letter-spacing: 0.1em; text-transform: uppercase;">
                Historical Market Reasoning</p>
        </div>

        <!-- SELECTOR BAR (BENTO STYLE) -->
        <div class="select-bar">
            <div class="select-grid">
                <div>
                    <label class="label-tiny">ASSET</label>
                    <select id="lab-asset" class="lab-input">
                        <option value="EURUSD">EUR/USD</option>
                        <option value="GBPUSD">GBP/USD</option>
                        <option value="USDJPY">USD/JPY</option>
                    </select>
                </div>
                <div>
                    <label class="label-tiny">TIMEFRAME</label>
                    <select id="lab-tf" class="lab-input">
                        <option value="M15">M15</option>
                        <option value="H1">H1</option>
                        <option value="H4">H4</option>
                    </select>
                </div>
                <div>
                    <label class="label-tiny">REFERENCE POINT (UTC)</label>
                    <input type="datetime-local" id="lab-time" class="lab-input">
                </div>
                <div class="btn-run-wrap">
                    <button onclick="runLabReasoning()" class="btn-analyze btn-bright"
                        style="width: 100%; height: 46px; border-radius: 8px; font-weight: 800; font-size: 0.8rem; box-shadow: 0 4px 20px rgba(56, 189, 248, 0.2);">RUN
                        AI REASONING</button>
                </div>
            </div>
            <p style="text-align: center; color: var(--warning); font-size: 0.65rem; margin-top: 16px; opacity: 0.8;">
                ‚ùó No auto-run. System will freeze dataset at the specified timestamp (Strictly No Lookahead).
            </p>
        </div>

        <!-- BENTO GRID OUTPUT -->
        <div id="lab-output-area" style="display: none;">
            <div class="lab-bento-grid">
                <!-- REASONING SNAPSHOT -->
                <div>
                    <div class="bento-header" style="color: #ff4785;">
                        <span
                            style="font-size: 12px; border-radius: 50%; background: #ff4785; width: 8px; height: 8px; display: inline-block;"></span>
                        REASONING SNAPSHOT
                    </div>
                    <div class="reasoning-box">
                        <div style="margin-bottom: 40px;">
                            <div class="label-tiny">STRUCTURE STATE</div>
                            <div id="res-state"
                                style="font-size: 2rem; font-weight: 800; color: var(--text-main); letter-spacing: -0.01em;">
                                BULLISH_CONTINUATION</div>
                        </div>

                        <div style="margin-bottom: 40px;">
                            <div class="label-tiny" style="margin-bottom: 16px;">DETECTED MARKET CONDITIONS (EVIDENCE)
                            </div>
                            <ul id="res-evidence"
                                style="list-style: none; padding: 0; display: flex; flex-direction: column; gap: 16px;">
                                <li style="display: flex; gap: 12px; color: var(--text-dim); font-size: 0.95rem;">
                                    <span style="color: var(--highlight);">‚úî</span> Higher Low confirmed at reference
                                    point
                                </li>
                                <li style="display: flex; gap: 12px; color: var(--text-dim); font-size: 0.95rem;">
                                    <span style="color: var(--highlight);">‚úî</span> No structure break detected in
                                    lookback period
                                </li>
                                <li style="display: flex; gap: 12px; color: var(--text-dim); font-size: 0.95rem;">
                                    <span style="color: var(--highlight);">‚úî</span> Momentum aligned with Primary
                                    structure
                                </li>
                            </ul>
                        </div>

                        <div>
                            <div class="label-tiny" style="color: #ef4444; margin-bottom: 12px;">INVALIDATION LOGIC
                            </div>
                            <div id="res-invalidation"
                                style="color: var(--text-dim); font-size: 0.9rem; line-height: 1.6;">
                                Reference snapshot becomes invalid if price breaks below <span
                                    style="font-family: 'JetBrains Mono'; color: #ef4444; font-weight: 700;">1.16480</span>.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- HISTORICAL REFERENCE -->
                <div>
                    <div class="bento-header">
                        <span style="font-size: 1rem;">üìã</span> HISTORICAL REFERENCE
                    </div>
                    <div id="lab-card-container">
                        <!-- Reference card injected here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- INFO GRID -->
        <div style="margin-top: 100px; padding-top: 60px; border-top: 1px solid var(--border);">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px;">
                <div>
                    <h3
                        style="color: var(--accent); font-size: 0.8rem; font-weight: 800; text-transform: uppercase; margin-bottom: 20px;">
                        ‚úÖ Quantix Lab Role</h3>
                    <p style="color: var(--text-dim); font-size: 0.85rem; line-height: 1.8;">
                        A transparent environment for auditing AI logic. It ensures that every structural bias is
                        explainable and verifiable against historical tick data, without the noise of current market
                        fluctuations.
                    </p>
                </div>
                <div>
                    <h3
                        style="color: #ef4444; font-size: 0.8rem; font-weight: 800; text-transform: uppercase; margin-bottom: 20px;">
                        ‚ùå Legal Boundaries</h3>
                    <p style="color: var(--text-dim); font-size: 0.85rem; line-height: 1.8;">
                        This is an explorer, not an advisor. Historical reasoning does not predict future performance.
                        All snapshots are static and do not constitute financial recommendations.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <footer class="app-footer" style="margin-top: 120px;">
        <div class="disclaimer">‚ö†Ô∏è Not financial advice. For research purposes only. Quantix Lab v1.0.4a</div>
    </footer>

    <script>
        // Set default time to now for convenience (UTC)
        window.onload = () => {
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('lab-time').value = now.toISOString().slice(0, 16);
        };

        async function runLabReasoning() {
            const asset = document.getElementById('lab-asset').value;
            const tf = document.getElementById('lab-tf').value;
            const time = document.getElementById('lab-time').value;

            if (!time) {
                alert("Please specify a timestamp.");
                return;
            }

            const output = document.getElementById('lab-output-area');
            output.style.display = 'block';

            // Mocking logic
            const container = document.getElementById('lab-card-container');
            container.innerHTML = `
                <div class="reference-card-bento" style="animation: fadeInUp 0.5s ease forwards;">
                    <div style="font-size: 1.25rem; font-weight: 800; margin-bottom: 4px; color: var(--text-main);">BUY</div>
                    <div style="font-size: 1rem; color: var(--text-dim); margin-bottom: 4px;">${asset.slice(0, 3)}/${asset.slice(3, 6)}</div>
                    <div style="font-size: 0.85rem; color: var(--text-dim); margin-bottom: 24px;">‚è≥ ${tf} ‚Ä¢ Historical Snapshot</div>
                    
                    <div style="margin-bottom: 32px;">
                        <div style="font-size: 0.9rem; font-weight: 800; color: var(--highlight);">96% Confidence</div>
                        <div class="confidence-meter" style="height: 4px; margin-top: 8px;">
                            <div class="confidence-fill" style="width: 96%; background: var(--highlight)"></div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.25); border: 1px solid var(--border); border-radius: 12px; padding: 20px;">
                        <div style="margin-bottom: 24px;">
                            <div class="label-tiny">ENTRY ZONE (HISTORICAL)</div>
                            <div style="font-family: 'JetBrains Mono'; font-size: 1.1rem; color: var(--text-main);">1.16710 ‚Äî 1.16750</div>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <div>
                                <div class="label-tiny">TP LEVEL</div>
                                <div style="font-family: 'JetBrains Mono'; color: var(--highlight); font-weight: 800;">1.17080</div>
                            </div>
                            <div style="text-align: right;">
                                <div class="label-tiny">SL LEVEL</div>
                                <div style="font-family: 'JetBrains Mono'; color: #ef4444; font-weight: 800;">1.16480</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 32px; font-size: 0.65rem; color: var(--text-dim); font-family: 'JetBrains Mono'; line-height: 1.6;">
                        SNAPSHOT POINT: ${time.replace('T', ' ')}<br>
                        DATA SOURCE: DUKASCOPY (UTC)
                    </div>
                </div>
            `;

            window.scrollTo({
                top: output.offsetTop - 100,
                behavior: 'smooth'
            });
        }
    </script>
    <script src="../static/js/ui_shared.js"></script>
</body>

</html>