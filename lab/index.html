<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantix Lab | Quantix AI Core</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/png" href="../static/img/favicon.png">
    <style>
        .control-panel {
            background: var(--bg-sub);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-group label {
            font-size: 0.65rem;
            color: var(--text-dim);
            text-transform: uppercase;
            font-weight: 700;
        }

        select,
        input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .btn-analyze {
            background: var(--accent);
            color: var(--bg-main);
            border: none;
            padding: 12px;
            border-radius: 4px;
            font-weight: 800;
            font-size: 0.8rem;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .btn-analyze:hover {
            opacity: 0.9;
        }

        .evidence-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 10px;
            font-size: 0.8rem;
            margin-bottom: 8px;
            display: flex;
            gap: 10px;
        }

        .state-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 800;
            text-transform: uppercase;
        }

        .state-badge.bullish {
            background: rgba(16, 185, 129, 0.1);
            color: var(--highlight);
        }

        .state-badge.bearish {
            background: rgba(244, 63, 94, 0.1);
            color: var(--warning);
        }
    </style>
</head>

<body class="scrollable-page">
    <header class="app-header">
        <div class="logo-area">
            <div class="logo-icon"></div>
            <span class="logo-text">QUANTIX AI CORE</span>
        </div>
        <div class="hamburger" id="menu-toggle">‚ò∞</div>
        <nav class="main-nav" id="main-nav">
            <a href="../" class="nav-link">Overview</a>
            <a href="../dashboard/" class="nav-link">Live System</a>
            <a href="../signals/" class="nav-link">Market Reference</a>
            <a href="../lab/" class="nav-link active">Quantix Lab</a>
            <a href="../api/" class="nav-link">API</a>
            <a href="../disclaimer/" class="nav-link">Legal</a>
        </nav>
        <div class="status-tag hide-mobile"
            style="width: 240px; display: flex; justify-content: flex-end; font-size: 0.7rem; color: var(--text-dim); align-items: center; gap: 8px;">
            <div class="dot dot-online"></div> LAB_EXPLORER_ACTIVE
        </div>
    </header>

    <main class="content-container">
        <!-- TOP CONTEXT BANNER -->
        <div
            style="background: rgba(56, 189, 248, 0.1); border: 1px solid var(--accent); padding: 16px; border-radius: 8px; margin-bottom: 40px; text-align: center;">
            <span style="color: var(--highlight); font-weight: 800;">üß™ Quantix Lab ‚Äì Historical AI Reasoning</span><br>
            <span style="font-size: 0.85rem; color: var(--text-dim);">This snapshot shows how the AI interpreted the
                market structure at a specific point in time.</span>
        </div>

        <div class="signals-header">
            <h1 style="font-size: 2.8rem; font-weight: 800; margin-bottom: 12px; letter-spacing: -0.02em;">Quantix Lab
            </h1>
            <p
                style="color: var(--accent); font-weight: 700; font-size: 1.1rem; letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 12px;">
                Market Reasoning Explorer</p>
            <p style="color: var(--text-dim); max-width: 700px; margin: 0 auto; line-height: 1.6;">
                Quantix Lab allows traders and partners to explore how Quantix AI interpreted market structure at
                specific historical moments.
                It is a transparent reasoning environment, not a trading system.
            </p>
        </div>

        <!-- PURPOSE SECTION -->
        <div
            style="max-width: 800px; margin: 40px auto; background: rgba(0,0,0,0.2); border: 1px solid var(--border); padding: 32px; border-radius: 16px;">
            <h2 style="font-size: 1.25rem; color: var(--text-main); margin-bottom: 16px;">üéØ Purpose</h2>
            <p style="color: var(--text-dim); line-height: 1.6; font-size: 0.95rem;">
                Explore how Quantix AI reasoned about market structure at a specific point in time.
                This environment is for research and educational purposes only. It does not provide trading advice,
                does not claim performance, and is not a financial recommendation engine.
            </p>
        </div>

        <!-- SELECTOR -->
        <div
            style="background: var(--bg-sub); border: 1px solid var(--border); padding: 40px; border-radius: 16px; margin-bottom: 60px;">
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 24px; align-items: flex-end;">
                <div>
                    <label
                        style="display: block; font-size: 0.7rem; color: var(--accent); font-weight: 800; margin-bottom: 8px;">ASSET</label>
                    <select id="lab-asset"
                        style="width: 100%; background: #000; color: #fff; border: 1px solid var(--border); padding: 12px; border-radius: 8px;">
                        <option value="EURUSD">EUR/USD</option>
                        <option value="GBPUSD">GBP/USD</option>
                        <option value="USDJPY">USD/JPY</option>
                    </select>
                </div>
                <div>
                    <label
                        style="display: block; font-size: 0.7rem; color: var(--accent); font-weight: 800; margin-bottom: 8px;">TIMEFRAME</label>
                    <select id="lab-tf"
                        style="width: 100%; background: #000; color: #fff; border: 1px solid var(--border); padding: 12px; border-radius: 8px;">
                        <option value="M15">M15</option>
                        <option value="H1">H1</option>
                        <option value="H4">H4</option>
                    </select>
                </div>
                <div>
                    <label
                        style="display: block; font-size: 0.7rem; color: var(--accent); font-weight: 800; margin-bottom: 8px;">REFERENCE
                        POINT (UTC)</label>
                    <input type="datetime-local" id="lab-time"
                        style="width: 100%; background: #000; color: #fff; border: 1px solid var(--border); padding: 12px; border-radius: 8px;">
                </div>
                <button onclick="runLabReasoning()" class="btn-analyze btn-bright"
                    style="width: 100%; height: 48px; border-radius: 8px; font-weight: 800;">RUN AI REASONING</button>
            </div>
            <p style="text-align: center; color: var(--text-dim); font-size: 0.7rem; margin-top: 20px;">
                ‚ùó No auto-run. System will freeze dataset at the specified timestamp (Strictly No Lookahead).
            </p>
        </div>

        <!-- REASONING OUTPUT (Initially Hidden) -->
        <div id="lab-results"
            style="display: none; grid-template-columns: 1.5fr 1fr; gap: 40px; animation: fadeIn 0.5s ease;">
            <div>
                <h2 class="section-title">üß† Reasoning Snapshot</h2>
                <div
                    style="background: rgba(0,0,0,0.2); border: 1px solid var(--border); padding: 32px; border-radius: 12px;">
                    <div style="margin-bottom: 32px;">
                        <div
                            style="font-size: 0.7rem; color: var(--accent); font-weight: 800; text-transform: uppercase;">
                            Structure State</div>
                        <div id="res-state" style="font-size: 1.5rem; font-weight: 800; color: var(--text-main);">...
                        </div>
                    </div>

                    <div style="margin-bottom: 32px;">
                        <div
                            style="font-size: 0.7rem; color: var(--accent); font-weight: 800; text-transform: uppercase; margin-bottom: 8px;">
                            Detected Market Conditions (Evidence)</div>
                        <ul id="res-evidence"
                            style="list-style: none; padding: 0; display: flex; flex-direction: column; gap: 12px;">
                            <!-- Evidence items injected here -->
                        </ul>
                    </div>

                    <div>
                        <div
                            style="font-size: 0.7rem; color: #ef4444; font-weight: 800; text-transform: uppercase; margin-bottom: 8px;">
                            Invalidation Logic</div>
                        <div id="res-invalidation" style="color: var(--text-dim); font-size: 0.9rem;">...</div>
                    </div>
                </div>
            </div>

            <div>
                <h2 class="section-title">üìã Historical Reference</h2>
                <div id="lab-card-container">
                    <!-- Historical Reference Card injected here -->
                </div>
            </div>
        </div>

        <div style="margin-top: 80px; padding-top: 40px; border-top: 1px solid var(--border);">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                <div>
                    <h3 style="color: var(--accent); font-size: 0.9rem; margin-bottom: 12px;">‚úÖ What it IS</h3>
                    <ul
                        style="color: var(--text-dim); font-size: 0.8rem; list-style: none; padding: 0; display: flex; flex-direction: column; gap: 8px;">
                        <li>‚Ä¢ Explainable AI lab</li>
                        <li>‚Ä¢ Market reasoning explorer</li>
                        <li>‚Ä¢ Partner demo & audit tool</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: #ef4444; font-size: 0.9rem; margin-bottom: 12px;">‚ùå What it is NOT</h3>
                    <ul
                        style="color: var(--text-dim); font-size: 0.8rem; list-style: none; padding: 0; display: flex; flex-direction: column; gap: 8px;">
                        <li>‚Ä¢ Signal service or trading bot</li>
                        <li>‚Ä¢ Backtest performance tracker</li>
                        <li>‚Ä¢ Financial recommendation engine</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="disclaimer-box" style="margin-top: 60px; text-align: center; border-style: dashed;">
            ‚ö†Ô∏è <strong>Disclaimer:</strong> For research and educational purposes only. Not trading advice. No
            performance claims.
        </div>
    </main>

    <footer class="app-footer">
        <div class="disclaimer">Institutional Grade Reference Engine. Quantix Lab v1.0a</div>
    </footer>

    <script>
        async function runLabReasoning() {
            const asset = document.getElementById('lab-asset').value;
            const tf = document.getElementById('lab-tf').value;
            const time = document.getElementById('lab-time').value;

            if (!time) {
                alert("Please select a Reference Point (Timestamp).");
                return;
            }

            const results = document.getElementById('lab-results');
            results.style.display = 'grid';

            // Mocking the behavior for Lab Explorer
            document.getElementById('res-state').innerText = "CALCULATING...";

            setTimeout(() => {
                document.getElementById('res-state').innerText = "BULLISH_CONTINUATION";
                document.getElementById('res-evidence').innerHTML = `
                    <li style="display: flex; gap: 12px; color: var(--text-dim); font-size: 0.9rem;"><span style="color: var(--highlight);">‚úî</span> Higher Low confirmed at reference point</li>
                    <li style="display: flex; gap: 12px; color: var(--text-dim); font-size: 0.9rem;"><span style="color: var(--highlight);">‚úî</span> No structure break detected in lookback period</li>
                    <li style="display: flex; gap: 12px; color: var(--text-dim); font-size: 0.9rem;"><span style="color: var(--highlight);">‚úî</span> Momentum aligned with Primary structure</li>
                `;
                document.getElementById('res-invalidation').innerHTML = `Reference snapshot becomes invalid if price breaks below <span style="font-family: 'JetBrains Mono'; color: #ef4444;">1.16480</span>.`;

                renderLabCard(asset, tf, time);
            }, 800);
        }

        function renderLabCard(asset, tf, time) {
            const container = document.getElementById('lab-card-container');
            container.innerHTML = `
                <div class="reference-card" style="border-color: var(--accent); animation: slideIn 0.3s ease;">
                    <div style="position: absolute; top: 12px; left: 12px; display: flex; gap: 6px;">
                        <span style="font-size: 0.5rem; background: rgba(56,189,248,0.1); color: var(--accent); padding: 2px 6px; border-radius: 4px; border: 1px solid var(--accent);">HISTORICAL REFERENCE</span>
                    </div>
                    <div class="card-badge badge-bullish" style="top: 24px;">BUY</div>
                    <div class="symbol-title" style="margin-top: 10px;">${asset.slice(0, 3)}/${asset.slice(3, 6)}</div>
                    <span class="timeframe-label">‚è≥ ${tf} ‚Ä¢ Historical Snapshot</span>
                    
                    <div style="margin: 20px 0;">
                        <div style="font-size: 0.9rem; font-weight: 800; color: var(--highlight);">96% Confidence</div>
                        <div class="confidence-meter" style="height: 4px; margin-top: 4px;">
                            <div class="confidence-fill" style="width: 96%; background: var(--highlight)"></div>
                        </div>
                    </div>
                    
                    <div class="level-grid" style="background: rgba(0,0,0,0.2); padding: 16px; border-radius: 8px; border: 1px solid var(--border);">
                        <div class="level-item" style="grid-column: 1 / -1; background: transparent; border: none; padding: 0; margin-bottom: 12px;">
                            <div class="level-label">Entry Zone (Historical)</div>
                            <div class="level-value">1.16710 ‚Äî 1.16750</div>
                        </div>
                        <div class="level-item" style="background: transparent; border: none; padding: 0;">
                            <div class="level-label">TP Level</div>
                            <div class="level-value" style="color: var(--highlight);">1.17080</div>
                        </div>
                        <div class="level-item" style="background: transparent; border: none; padding: 0; text-align: right;">
                            <div class="level-label">SL Level</div>
                            <div class="level-value" style="color: #ef4444;">1.16480</div>
                        </div>
                    </div>

                    <div style="margin-top: 20px; font-size: 0.6rem; color: var(--text-dim); font-family: 'JetBrains Mono';">
                        SNAPSHOT POINT: ${time}<br>
                        DATA SOURCE: DUKASCOPY (UTC)
                    </div>
                </div>
            `;
        }
    </script>
    <script src="../static/js/ui_shared.js"></script>
</body>

</html>